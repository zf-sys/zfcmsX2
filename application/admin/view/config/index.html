<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>管理系统</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="__STATIC__/style/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="__STATIC__/system/style/admin.css" media="all">
</head>
<body>


  <div class="layui-fluid">
    <div class="layui-row layui-col-space15">
      <div class="layui-col-md12">

        <div class="layui-card">
          <div class="layui-card-header layuiadmin-card-header-auto">
              <a class="layui-btn layui-btn-sm" href='{:url("config/index")}?type=网站设置'>网站设置</a>
              <a class="layui-btn layui-btn-sm" href='{:url("config/index")}?type=系统设置'>系统设置</a>
              <!-- <a class="layui-btn layui-btn-sm" href='{:url("config/index")}?type=模板设置'>模板设置</a> -->
              <!-- <a class="layui-btn layui-btn-sm" href='{:url("config/index")}?type=SEO优化'>SEO优化</a> -->
          </div>
          <div class="layui-card-header">{$type}</div>
          <div class="layui-card-body" pad15>
            <form class="info_tj" >
              <div class="layui-form" wid100 lay-filter="">
                <?php if($type=='网站设置'){ ?>
                <div class="layui-form-item">
                  <label class="layui-form-label">网站名称</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_name" value="{$config['site_name']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_name']</span>网站名称</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">网站域名</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_url"  value="{$config['site_url']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_url']</span>网站域名</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">管理员邮箱</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_mail"  value="{$config['site_mail']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_mail']</span>管理员邮箱</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">公司电话</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_hotline"  value="{$config['site_hotline']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_hotline']</span>公司电话</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">公司传真</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_fax"  value="{$config['site_fax']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_fax']</span>公司传真</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">QQ</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_qq"  value="{$config['site_qq']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_qq']</span>QQ</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">微信</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_wx"  value="{$config['site_wx']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_wx']</span>微信</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">公司地址</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_address"  value="{$config['site_address']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_address']</span>公司地址</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">ICP备案号</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_icp"  value="{$config['site_icp']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_icp']</span>ICP备案号</div>
                </div>
                <div class="layui-form-item layui-form-text">
                  <label class="layui-form-label">管理系统标题</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <textarea name="site_title" class="layui-textarea">{$config['site_title']}</textarea>
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_title']</span>管理系统标题</div>
                </div>
                <div class="layui-form-item layui-form-text">
                  <label class="layui-form-label">META关键词</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <textarea name="site_keywords" class="layui-textarea" placeholder="多个关键词用英文状态 , 号分割">{$config['site_keywords']}</textarea>
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_keywords']</span>META关键词</div>
                </div>
                <div class="layui-form-item layui-form-text">
                  <label class="layui-form-label">META描述</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <textarea name="site_description" class="layui-textarea">{$config['site_description']}</textarea>
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_description']</span>META描述</div>
                </div>
                <div class="layui-form-item layui-form-text">
                  <label class="layui-form-label">版权信息</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <textarea name="site_copyright" class="layui-textarea">{$config['site_copyright']}</textarea>
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_copyright']</span>版权信息</div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">网站logo:</label>
                    <div class="layui-input-inline" style="width: 500px;">
                      <input type="text" name="site_logo"   id="main_site_logo" placeholder="" autocomplete="off" class="layui-input " value="{$config['site_logo']}">
                      <span type="button" class="layui-btn  layui-btn-sm" id="up_img_site_logo">上传图片</span>
                    </div>
                    <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_logo']</span>网站logo</div>
                  </div>
                  <div class="layui-form-item">
                    <label class="layui-form-label">网站Icon:</label>
                    <div class="layui-input-inline" style="width: 500px;">
                      <input type="text" name="site_icon"   id="main_site_icon" placeholder="" autocomplete="off" class="layui-input" value="{$config['site_icon']}">
                      <span type="button" class="layui-btn  layui-btn-sm" id="up_img_site_icon">上传图片</span>
                    </div>
                    <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_icon']</span>网站Icon</div>
                  </div>
                   <div class="layui-form-item">
                    <label class="layui-form-label">微信二维码:</label>
                    <div class="layui-input-inline" style="width: 500px;">
                      <input type="text" name="site_qrcode"   id="main_site_qrcode" placeholder="" autocomplete="off" class="layui-input" value="{$config['site_qrcode']}">
                      <span type="button" class="layui-btn  layui-btn-sm" id="up_img_site_qrcode">上传图片</span>
                    </div>
                    <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_qrcode']</span>微信二维码</div>
                  </div>

                
                <?php }elseif($type=='系统设置'){ ?>
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">关键词过滤</label>
                    <div class="layui-input-inline" style="width: 500px;">
                        <textarea name="key_filter" class="layui-textarea">{$config['key_filter']}</textarea>
                    </div>
                    <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['key_filter']</span><br>使用说明:$config['content'] = str_replace(explode(',',config('web.key_filter')),'*',$config['content']);
                    </div>
                </div>
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">上传设置</label>
                    <div class="layui-input-inline" style="width: 500px;">
                      <select name="upload_type">
                        <option value="" {$config['upload_type']==''?'selected':''}>本地</option>
                        <option value="ali" {$config['upload_type']=='ali'?'selected':''}>阿里云oss</option>
                        <option value="qny" {$config['upload_type']=='qny'?'selected':''}>七牛云oss</option>
                        <option value="upy" {$config['upload_type']=='upy'?'selected':''}>又拍云oss</option>
                      </select>
                    </div>
                    <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['upload_type'] 使用oss上传,请先进行配置</span><br>
                    </div>
                </div>
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">图片上传扩展</label>
                    <div class="layui-input-inline" style="width: 500px;">
                        <textarea name="pic_ext" class="layui-textarea">{$config['pic_ext']}</textarea>
                    </div>
                    <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['pic_ext'] 不适用于oss上传</span><br>
                    </div>
                </div>
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">文件上传扩展</label>
                    <div class="layui-input-inline" style="width: 500px;">
                        <textarea name="file_ext" class="layui-textarea">{$config['file_ext']}</textarea>
                    </div>
                    <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['file_ext'] 不适用于oss上传</span><br>
                    </div>
                </div>
                
                <div class="layui-form-item layui-form-text">
                  <label class="layui-form-label">统计代码</label>
                  <div class="layui-input-inline" style="width: 500px;">
                      <textarea name="tongji_code" class="layui-textarea">{$config['tongji_code']}</textarea>
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">json_decode(config()['web']['tongji_code']) </span><br>
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">开启日志:</label>
                  <div class="layui-input-inline">
                    <input type="radio" name="is_log" value="0" title="关闭" <?php echo $config['is_log']==0?'checked':''; ?>><div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i><div>开启</div></div>
                    <input type="radio" name="is_log" value="1" title="开启" <?php echo $config['is_log']==1?'checked':''; ?> ><div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i><div>关闭</div></div>                    
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['is_log']</span>开启日志</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">站点状态:</label>
                  <div class="layui-input-inline">
                    <input type="radio" name="site_closed" value="1" title="关闭" <?php echo $config['site_closed']==1?'checked':''; ?> ><div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i><div>关闭</div></div>
                    <input type="radio" name="site_closed" value="0" title="开启" <?php echo $config['site_closed']==0?'checked':''; ?>><div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i><div>开启</div></div>
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_closed']</span>站点状态</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">关闭站点跳转</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_closed_url"  value="{$config['site_closed_url']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_closed_url']</span>站点关闭后跳转的链接</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">首页跳转链接</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_home_url"  value="{$config['site_home_url']|default=''}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux"><span class="layui-badge  layui-bg-cyan">config()['web']['site_home_url']</span>打开站点首页跳转的链接</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">站点Token</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="site_token"  value="{$config['site_token']}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux">禁止泄露,可修改</div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">后台自定义登录路径token</label>
                  <div class="layui-input-inline" style="width: 500px;">
                    <input type="text" name="admin_path"  value="{$config['admin_path']|default=''}" class="layui-input">
                  </div>
                  <div class="layui-form-mid layui-word-aux">不为空时,后台登录路径改为 /adminLogin/设置的路径token ,原来的登录路径失效</div>
                </div>
                
                
                <?php } ?>


                <div class="layui-form-item">
                  <div class="layui-input-block">
                    <a href="javascript:;" class="layui-btn layui-btn-sm"  onclick="tijiao_data2('config/index',0)" >确认保存</a>
                  </div>
                </div>


              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="__STATIC__/style/layui/layui.js"></script>    
  <script type="text/javascript" src="__STATIC__/system/common.js"></script>  

  <script>
 layui.define(['form', 'upload'], function(exports){
  var $ = layui.$
  ,layer = layui.layer
  ,laytpl = layui.laytpl
  ,setter = layui.setter
  ,view = layui.view
  ,admin = layui.admin
  ,form = layui.form
  ,upload = layui.upload;


  upload.render({
      elem: '#up_img_site_icon'
      ,url: "{:url('common/upload/upload_one_file')}"
      ,done: function(res){
        console.log(res)
        if(res.result==1){
            layer.msg("上传成功", {icon: 1});
            $("#main_site_icon").val(res.msg);
        }else{
          layer.msg('上传失败', {icon: 1});
        }
      }
    });
    upload.render({
      elem: '#up_img_site_logo'
      ,url: "{:url('common/upload/upload_one_file')}"
      ,done: function(res){
        console.log(res)
        if(res.result==1){
            layer.msg("上传成功", {icon: 1});
            $("#main_site_logo").val(res.msg);
        }else{
          layer.msg('上传失败', {icon: 1});
        }
      }
    });
    upload.render({
      elem: '#up_img_site_qrcode'
      ,url: "{:url('common/upload/upload_one_file')}"
      ,done: function(res){
        console.log(res)
        if(res.result==1){
            layer.msg("上传成功", {icon: 1});
            $("#main_site_qrcode").val(res.msg);
        }else{
          layer.msg('上传失败', {icon: 1});
        }
      }
    });

    window.tijiao_data2 = function(role,type=1){
      var index = layer.load(2);
      var data = $(".info_tj input,.info_tj select,.info_tj textarea,.info_tj radio").serialize();      
      $.ajax({
        type:'post',
        url:'../'+role,
        data:data,
        dataType:'json',
        success:function(res){
          console.log(res)
          if(res.result==1){
            layer.msg(res.msg, {icon: 1});
            layer.close(index)
            setTimeout(function() {
              if(type==1){
              parent.location.reload();
              }else{
              // location.reload();
              }
            }, 2000);
          }else{
            layer.msg(res.msg, {icon: 2});
            layer.close(index)
          }   
        }
      })
    }
   


 })
  </script>
</body>
</html>